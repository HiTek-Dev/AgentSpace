---
phase: 27-desktop-ui-overhaul
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/desktop/src/components/ChatMessage.tsx
  - apps/desktop/src/pages/ChatPage.tsx
autonomous: true
gap_closure: true
requirements:
  - DSKV-06

must_haves:
  truths:
    - "bash_command card uses bg-surface-primary and border-surface-overlay instead of bg-gray-900 and border-gray-700"
    - "reasoning card uses bg-surface-elevated/40, border-brand-500/30, and text-brand-400/60 instead of gray/blue hardcoded classes"
    - "ToolCallCard uses bg-surface-elevated/60 and border-surface-overlay instead of bg-gray-800/60 and border-gray-700"
    - "ChatPage header bar uses bg-surface-primary/50 and border-surface-overlay instead of bg-gray-900/50 and border-gray-700"
    - "Agent select dropdown uses bg-surface-elevated, border-surface-overlay, text-text-primary, and focus:border-brand-500"
    - "All text-gray-500 labels in ChatMessage and ChatPage replaced with text-text-muted"
    - "All text-gray-100 content text replaced with text-text-primary"
    - "All text-gray-400 secondary text replaced with text-text-secondary"
  artifacts:
    - path: "apps/desktop/src/components/ChatMessage.tsx"
      provides: "Fully token-migrated chat message cards"
      contains: "bg-surface-primary"
    - path: "apps/desktop/src/pages/ChatPage.tsx"
      provides: "Fully token-migrated chat page header"
      contains: "bg-surface-primary"
  key_links:
    - from: "apps/desktop/src/index.css"
      to: "apps/desktop/src/components/ChatMessage.tsx"
      via: "@theme design tokens used as Tailwind classes"
      pattern: "bg-surface-|text-text-|border-surface-|border-brand-|text-brand-"
    - from: "apps/desktop/src/index.css"
      to: "apps/desktop/src/pages/ChatPage.tsx"
      via: "@theme design tokens used as Tailwind classes"
      pattern: "bg-surface-|text-text-|border-surface-|border-brand-"
---

<objective>
Migrate all remaining hardcoded gray/blue Tailwind classes in ChatMessage.tsx (14 occurrences) and ChatPage.tsx (7 occurrences) to the design token system defined in index.css @theme.

Purpose: Close the DSKV-06 gap identified in verification — bash_command, reasoning, ToolCallCard, and ChatPage header still use pre-overhaul hardcoded colors instead of brand design tokens.

Output: Both files use exclusively design token classes (bg-surface-*, text-text-*, border-surface-*, border-brand-*, text-brand-*) with zero remaining gray-*/blue-* hardcoded classes (except semantic colors like green-400 for status indicators and red-400 for errors which are intentional).
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@apps/desktop/src/index.css
@apps/desktop/src/components/ChatMessage.tsx
@apps/desktop/src/pages/ChatPage.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate ChatMessage.tsx hardcoded colors to design tokens</name>
  <files>apps/desktop/src/components/ChatMessage.tsx</files>
  <action>
Replace all 14 hardcoded gray/blue Tailwind classes with design token equivalents. Apply these exact substitutions:

**User message section (lines ~40-44):**
- `text-gray-500` (User "You" label) → `text-text-muted`
- `text-gray-100` (user message text) → `text-text-primary`
- `text-gray-500` (user timestamp) → `text-text-muted`

**Assistant message section (lines ~57-63):**
- `text-gray-500` (Assistant label) → `text-text-muted`
- `text-gray-100` (assistant message text) → `text-text-primary`
- `text-gray-500` (assistant timestamp) → `text-text-muted`

**bash_command section (lines ~90-95):**
- `bg-gray-900 border border-gray-700` → `bg-surface-primary border border-surface-overlay`
- `text-gray-400` (output text) → `text-text-secondary`

**reasoning section (lines ~109-111):**
- `bg-gray-800/40 border-l-2 border-blue-500/30` → `bg-surface-elevated/40 border-l-2 border-brand-500/30`
- `text-blue-400/60` (thinking label) → `text-brand-400/60`
- `text-gray-400` (reasoning text) → `text-text-secondary`

**ToolCallCard (lines ~131-158):**
- `bg-gray-800/60 border border-gray-700` (container) → `bg-surface-elevated/60 border border-surface-overlay`
- `text-gray-400` (input pre) → `text-text-secondary`
- `text-gray-300` (output pre) → `text-text-primary`
- `border-t border-gray-700` (output border) → `border-t border-surface-overlay`

Do NOT change semantic status colors: green-400 (bash prompt, connected), red-400 (error), yellow-400 (warning/pending), yellow-600 (system messages). These are intentionally hardcoded for semantic meaning.
  </action>
  <verify>
Run: `grep -n 'gray-\|blue-[0-9]' apps/desktop/src/components/ChatMessage.tsx`
Expected: Zero matches (no remaining gray-* or blue-* classes). Semantic green-400, red-400, yellow-400 are acceptable and expected.
  </verify>
  <done>ChatMessage.tsx contains zero hardcoded gray-*/blue-* Tailwind classes; all 14 occurrences replaced with design token equivalents; semantic status colors preserved.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate ChatPage.tsx hardcoded colors to design tokens</name>
  <files>apps/desktop/src/pages/ChatPage.tsx</files>
  <action>
Replace all 7 hardcoded gray/blue Tailwind classes in the ChatPage header bar and agent select. Apply these exact substitutions:

**Header bar (line ~90):**
- `border-b border-gray-700 bg-gray-900/50` → `border-b border-surface-overlay bg-surface-primary/50`

**Header title (line ~92):**
- `text-gray-100` → `text-text-primary`

**Agent select dropdown (line ~99):**
- `bg-gray-800 border border-gray-700` → `bg-surface-elevated border border-surface-overlay`
- `text-gray-200` → `text-text-primary`
- `focus:border-blue-500` → `focus:border-brand-500`

**Connection status text (line ~112):**
- `text-gray-400` → `text-text-secondary`

**Session/model info container (line ~117):**
- `text-gray-500` → `text-text-muted`

**Model badge (line ~124):**
- `bg-gray-700 text-gray-400` → `bg-surface-overlay text-text-secondary`

**Empty state text (line ~139):**
- `text-gray-500` → `text-text-muted`

Do NOT change semantic colors: green-400 (connected dot), red-400 (disconnected dot, error text). These are intentional status indicators.
  </action>
  <verify>
Run: `grep -n 'gray-\|blue-[0-9]' apps/desktop/src/pages/ChatPage.tsx`
Expected: Zero matches for gray-* or blue-* classes. Semantic green-400 and red-400 are acceptable.
  </verify>
  <done>ChatPage.tsx contains zero hardcoded gray-*/blue-* Tailwind classes; all 7 header/select occurrences replaced with design token equivalents; status indicator colors preserved.</done>
</task>

</tasks>

<verification>
1. `grep -rn 'gray-[0-9]\|blue-[0-9]' apps/desktop/src/components/ChatMessage.tsx apps/desktop/src/pages/ChatPage.tsx` returns no matches
2. `grep -c 'surface-\|text-text-\|brand-' apps/desktop/src/components/ChatMessage.tsx` shows increased token usage vs current
3. `cd apps/desktop && npx tsc --noEmit` compiles without errors (class names are strings, so this confirms no structural breakage)
4. Visual spot-check: bash_command cards, reasoning cards, ToolCallCard, and ChatPage header should visually match the brand palette
</verification>

<success_criteria>
- Zero gray-*/blue-* hardcoded Tailwind color classes in ChatMessage.tsx and ChatPage.tsx (excluding semantic green/red/yellow status colors)
- All replaced classes use the @theme design token system: bg-surface-*, text-text-*, border-surface-*, border-brand-*, text-brand-*
- TypeScript compilation succeeds
- DSKV-06 requirement fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/27-desktop-ui-overhaul/27-06-SUMMARY.md`
</output>
