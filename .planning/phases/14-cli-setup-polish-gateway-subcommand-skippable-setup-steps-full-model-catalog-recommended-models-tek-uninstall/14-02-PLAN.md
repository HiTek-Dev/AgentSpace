---
phase: 14-cli-setup-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/cli/src/lib/models.ts
  - packages/cli/src/components/Onboarding.tsx
  - packages/cli/src/commands/init.ts
autonomous: true
requirements:
  - SC-02
  - SC-03
  - SC-04

must_haves:
  truths:
    - "Running `tek init` when already configured shows current values for each step and lets user skip"
    - "Model selection shows all text-capable models per configured provider with recommended models annotated"
    - "Venice model list includes 20+ text models from their API organized by tier"
    - "Recommended models are clearly marked (e.g. star or tag) in the selection UI"
    - "Skipping a step preserves the existing config value"
  artifacts:
    - path: "packages/cli/src/lib/models.ts"
      provides: "Centralized model catalog with recommendations per provider"
      exports: ["MODEL_CATALOG", "ModelInfo", "getModelsForProvider"]
    - path: "packages/cli/src/components/Onboarding.tsx"
      provides: "Skippable setup wizard with current-value display and full model catalog"
      contains: "Keep current"
  key_links:
    - from: "packages/cli/src/components/Onboarding.tsx"
      to: "packages/cli/src/lib/models.ts"
      via: "import MODEL_CATALOG for model selection step"
      pattern: "MODEL_CATALOG"
    - from: "packages/cli/src/commands/init.ts"
      to: "packages/cli/src/components/Onboarding.tsx"
      via: "passes existingConfig prop for skip support"
      pattern: "existingConfig"
---

<objective>
Create a centralized model catalog with per-provider recommendations and make the Onboarding wizard skippable with current-value display when re-running `tek init`.

Purpose: Users can re-run setup without re-entering everything, and model selection shows the full catalog with clear recommendations instead of a small hardcoded list.
Output: New model catalog module, updated Onboarding component, updated init command.
</objective>

<execution_context>
@/Users/hitekmedia/.claude/get-shit-done/workflows/execute-plan.md
@/Users/hitekmedia/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-cli-setup-polish-gateway-subcommand-skippable-setup-steps-full-model-catalog-recommended-models-tek-uninstall/14-RESEARCH.md

@packages/cli/src/components/Onboarding.tsx
@packages/cli/src/commands/init.ts
@packages/cli/src/vault/providers.ts
@packages/core/src/config/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create centralized model catalog with recommendations</name>
  <files>
    packages/cli/src/lib/models.ts
  </files>
  <action>
Create `packages/cli/src/lib/models.ts` with a comprehensive model catalog.

Define the `ModelInfo` interface:
```typescript
export interface ModelInfo {
  id: string;           // bare model ID, e.g. "llama-3.3-70b"
  displayName: string;  // human-readable name, e.g. "Llama 3.3 70B"
  recommended?: string; // recommendation tag: "general", "coding", "low-cost", "reasoning", "premium"
  tier?: "xs" | "s" | "m" | "l";  // size tier for Venice models
}
```

Export `MODEL_CATALOG` as `Record<string, ModelInfo[]>` with these providers:

**venice** (all text-capable models from research, ~20 models):
- `venice-uncensored` — "Venice Uncensored" — recommended: "general", tier: "s"
- `mistral-31-24b` — "Mistral Small 3.1" — tier: "s"
- `llama-3.2-3b` — "Llama 3.2 3B" — tier: "xs"
- `llama-3.3-70b` — "Llama 3.3 70B" — recommended: "low-cost", tier: "m"
- `qwen3-4b` — "Qwen3 4B" — tier: "xs"
- `qwen3-next-80b` — "Qwen3 Next 80B" — tier: "m"
- `qwen3-235b-a22b-instruct-2507` — "Qwen3 235B Instruct" — tier: "l"
- `qwen3-235b-a22b-thinking-2507` — "Qwen3 235B Thinking" — tier: "l"
- `qwen3-coder-480b-a35b-instruct` — "Qwen3 Coder 480B" — recommended: "coding", tier: "l"
- `qwen-2.5-qwq-32b` — "QwQ 32B" — recommended: "reasoning", tier: "m"
- `qwen-2.5-vl` — "Qwen 2.5 VL" — tier: "m"
- `qwen-2.5-coder-32b` — "Qwen 2.5 Coder 32B" — tier: "m"
- `deepseek-ai-DeepSeek-R1` — "DeepSeek R1 671B" — tier: "l"
- `google-gemma-3-27b-it` — "Google Gemma 3 27B" — tier: "m"
- `grok-41-fast` — "Grok 41 Fast" — tier: "l"
- `kimi-k2-thinking` — "Kimi K2 Thinking" — tier: "l"
- `gemini-3-pro-preview` — "Gemini 3 Pro Preview" — tier: "l"
- `hermes-3-llama-3.1-405b` — "Hermes 3 405B" — tier: "l"
- `zai-org-glm-4.7` — "GLM 4.7" — tier: "l"
- `openai-gpt-oss-120b` — "OpenAI GPT OSS 120B" — tier: "l"

**anthropic:**
- `claude-sonnet-4-5-20250929` — "Claude Sonnet 4.5" — recommended: "general"
- `claude-haiku-4-5-20250929` — "Claude Haiku 4.5" — recommended: "low-cost"
- `claude-opus-4-5-20250929` — "Claude Opus 4.5" — recommended: "premium"

**openai:**
- `gpt-4o` — "GPT-4o" — recommended: "general"
- `gpt-4o-mini` — "GPT-4o Mini" — recommended: "low-cost"
- `o3-mini` — "o3 Mini" — recommended: "reasoning"

**google:**
- `gemini-2.5-pro-preview-05-06` — "Gemini 2.5 Pro" — recommended: "general"
- `gemini-2.0-flash` — "Gemini 2.0 Flash" — recommended: "low-cost"

**ollama:** empty array (user provides their own local models)

Export a helper function `getModelsForProvider(provider: string): ModelInfo[]` that returns the models for a provider or empty array.

Export a helper function `buildModelOptions(provider: string): Array<{ label: string; value: string }>` that formats models for Ink Select, with recommended models getting a star prefix in their label (e.g., "★ Llama 3.3 70B (low-cost)" vs "Llama 3.2 3B"). The value should be the provider-qualified ID (e.g., `venice:llama-3.3-70b`).
  </action>
  <verify>
Run `cd /Users/hitekmedia/Documents/GitHub/tek && npx tsc -p packages/cli/tsconfig.json --noEmit` to verify compilation. Verify the file exports MODEL_CATALOG, ModelInfo, getModelsForProvider, and buildModelOptions.
  </verify>
  <done>
Model catalog exists with 20+ Venice models, all provider models, recommendation tags, and helper functions for Select formatting.
  </done>
</task>

<task type="auto">
  <name>Task 2: Make Onboarding wizard skippable with full model catalog</name>
  <files>
    packages/cli/src/components/Onboarding.tsx
    packages/cli/src/commands/init.ts
  </files>
  <action>
**In Onboarding.tsx:**

1. Add an `existingConfig` optional prop to `OnboardingProps`:
```typescript
interface OnboardingProps {
  onComplete: (result: OnboardingResult) => void;
  existingConfig?: {
    securityMode?: SecurityMode;
    workspaceDir?: string;
    defaultModel?: string;
    modelAliases?: ModelAliasEntry[];
    configuredProviders?: string[];  // providers with keys already set
  };
}
```

2. Replace the hardcoded `PROVIDER_MODELS` constant with imports from the new `../lib/models.js` module. Import `MODEL_CATALOG` and `buildModelOptions`.

3. For each interactive step (mode, workspace, keys-ask, model-select), when `existingConfig` is provided and has a value for that step, add a "Keep current: {value}" option at the top of the Select (or show current value and offer skip). Specifically:

- **mode step:** If `existingConfig.securityMode` exists, add a first option: `{ label: "Keep current: {Full Control|Limited Control}", value: "__keep__" }`. On selection of `__keep__`, use existing mode and advance to next step.

- **keys-ask step:** If `existingConfig.configuredProviders` has entries, show "Currently configured: {providers}". Change the prompt to "Would you like to change API keys?" and default behavior to skip to model selection on "No".

- **model-select step:** Replace `buildAvailableModels()` with `buildModelOptions()` from the models module. For each configured provider, call `buildModelOptions(provider)` and concatenate results. This gives the full catalog with recommendation stars. If `existingConfig.defaultModel` exists, add "Keep current: {model}" as the first option.

- **model-alias step:** If `existingConfig.modelAliases` exists, pre-populate `modelAliases` state with them and show current aliases. Add option to type "keep" to preserve existing aliases.

4. Initialize state from existingConfig where available:
- `useState<SecurityMode>(existingConfig?.securityMode ?? "full-control")`
- `useState(existingConfig?.workspaceDir ?? "")`
- `useState<ModelAliasEntry[]>(existingConfig?.modelAliases ?? [])`

**In init.ts:**

1. When `configExists()` is true and user confirms re-run, load the existing config with `loadConfig()` from `@tek/core`.
2. Also load configured providers by calling `listProviders()` from the vault module and filtering for those with `configured: true`.
3. Pass the existing config as the `existingConfig` prop to the Onboarding component:
```typescript
React.createElement(Onboarding, {
  onComplete: async (result) => { ... },
  existingConfig: existingConfig ? {
    securityMode: existingConfig.securityMode,
    workspaceDir: existingConfig.workspaceDir,
    defaultModel: existingConfig.defaultModel,
    modelAliases: existingConfig.modelAliases,
    configuredProviders: configuredProviderNames,
  } : undefined,
})
```
4. Import `loadConfig` from `@tek/core` and `listProviders` from the vault module.
  </action>
  <verify>
Run `cd /Users/hitekmedia/Documents/GitHub/tek && npx tsc -p packages/cli/tsconfig.json --noEmit` to verify compilation. Verify that Onboarding.tsx imports from `../lib/models.js` and accepts `existingConfig` prop. Verify init.ts passes existing config when re-running.
  </verify>
  <done>
Onboarding wizard shows current values with "Keep current" option for each step when re-running `tek init`. Model selection uses full catalog from models.ts with recommendation annotations. Venice shows 20+ text models. Init command loads and passes existing config.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc -p packages/cli/tsconfig.json --noEmit` passes
2. `grep "MODEL_CATALOG" packages/cli/src/lib/models.ts` confirms catalog exists
3. `grep -c "id:" packages/cli/src/lib/models.ts` shows 25+ model entries
4. `grep "existingConfig" packages/cli/src/components/Onboarding.tsx` shows skip support
5. `grep "Keep current" packages/cli/src/components/Onboarding.tsx` shows skip option text
6. `grep "loadConfig\|listProviders" packages/cli/src/commands/init.ts` shows config loading
7. `grep "buildModelOptions\|MODEL_CATALOG" packages/cli/src/components/Onboarding.tsx` confirms catalog integration
</verification>

<success_criteria>
- `tek init` re-run shows "Keep current: {value}" for mode, model, and aliases
- Model selection displays all Venice text models (20+) with starred recommendations
- All providers have models with recommendation tags (general, coding, low-cost, reasoning, premium)
- Skipping a step preserves the existing configuration value
- TypeScript compiles cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/14-cli-setup-polish-gateway-subcommand-skippable-setup-steps-full-model-catalog-recommended-models-tek-uninstall/14-02-SUMMARY.md`
</output>
